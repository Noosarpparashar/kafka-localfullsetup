[2022-08-14 08:33:22,868] INFO [Controller id=1 epoch=16] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-14 08:33:22,874] ERROR [Controller id=1 epoch=16] Controller 1 epoch 16 failed to change state for partition ssl-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition ssl-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-14 08:33:22,874] INFO [Controller id=1 epoch=16] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-14 08:33:22,882] INFO [Controller id=1 epoch=16] Partition ssl-topic-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:16) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-14 08:33:22,883] INFO [Controller id=1 epoch=16] Sending UpdateMetadata request to brokers HashSet(0, 1) for 1 partitions (state.change.logger)
[2022-08-14 08:33:22,893] INFO [Controller id=1 epoch=16] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-14 08:33:22,896] ERROR [Controller id=1 epoch=16] Controller 1 epoch 16 failed to change state for partition ssl-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition ssl-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-14 08:33:22,897] ERROR [Controller id=1 epoch=16] Controller 1 epoch 16 failed to change state for partition ssl-topic-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition ssl-topic-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-14 08:33:22,897] INFO [Controller id=1 epoch=16] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-14 08:33:22,900] INFO [Controller id=1 epoch=16] Partition ssl-topic-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:16) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-14 08:33:22,900] INFO [Controller id=1 epoch=16] Sending UpdateMetadata request to brokers HashSet(1) for 1 partitions (state.change.logger)
[2022-08-14 08:33:58,498] INFO [Controller id=0 epoch=17] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-08-14 08:33:58,515] INFO [Controller id=0 epoch=17] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-08-14 08:33:58,517] INFO [Controller id=0 epoch=17] Sending UpdateMetadata request to brokers HashSet(0) for 1 partitions (state.change.logger)
[2022-08-14 08:33:58,536] INFO [Controller id=0 epoch=17] Partition ssl-topic-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:17) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-14 08:33:58,540] INFO [Controller id=0 epoch=17] Partition ssl-topic-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:17) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-14 08:33:58,540] INFO [Controller id=0 epoch=17] Sending UpdateMetadata request to brokers HashSet(0) for 2 partitions (state.change.logger)
[2022-08-14 08:33:58,561] ERROR [Controller id=0 epoch=17] Controller 0 epoch 17 failed to change state for partition ssl-topic-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition ssl-topic-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-14 08:33:58,563] ERROR [Controller id=0 epoch=17] Controller 0 epoch 17 failed to change state for partition ssl-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition ssl-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-14 08:33:58,564] INFO [Controller id=0 epoch=17] Changed partition ssl-topic-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=7, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2022-08-14 08:33:58,564] INFO [Controller id=0 epoch=17] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2022-08-14 08:33:58,565] INFO [Controller id=0 epoch=17] Sending UpdateMetadata request to brokers HashSet(0) for 1 partitions (state.change.logger)
[2022-08-14 08:33:58,976] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 1 partitions (state.change.logger)
[2022-08-14 08:33:58,990] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 17 for partition ssl-topic-2 (last update controller epoch 16) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-14 08:33:58,992] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 17 with correlation id 1 for 0 partitions (state.change.logger)
[2022-08-14 08:33:58,998] INFO [Broker id=0] Finished LeaderAndIsr request in 22ms correlationId 1 from controller 0 for 1 partitions (state.change.logger)
[2022-08-14 08:33:59,003] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 2 (state.change.logger)
[2022-08-14 08:33:59,005] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 3 (state.change.logger)
[2022-08-14 08:33:59,007] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 4 from controller 0 for 1 partitions (state.change.logger)
[2022-08-14 08:33:59,008] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 4 from controller 0 epoch 17 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-08-14 08:33:59,011] INFO [Broker id=0] Leader ssl-topic-2 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-14 08:33:59,017] INFO [Broker id=0] Finished LeaderAndIsr request in 10ms correlationId 4 from controller 0 for 1 partitions (state.change.logger)
[2022-08-14 08:33:59,019] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 5 (state.change.logger)
[2022-08-14 08:34:02,064] INFO [Controller id=0 epoch=17] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-08-14 08:34:02,065] INFO [Controller id=0 epoch=17] Sending UpdateMetadata request to brokers HashSet(1) for 3 partitions (state.change.logger)
[2022-08-14 08:34:02,067] INFO [Controller id=0 epoch=17] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-08-14 08:34:02,067] INFO [Controller id=0 epoch=17] Sending UpdateMetadata request to brokers HashSet(0, 1) for 1 partitions (state.change.logger)
[2022-08-14 08:34:02,068] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 7 (state.change.logger)
[2022-08-14 08:34:02,076] ERROR [Controller id=0 epoch=17] Controller 0 epoch 17 failed to change state for partition ssl-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition ssl-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-14 08:34:02,076] INFO [Controller id=0 epoch=17] Changed partition ssl-topic-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2022-08-14 08:34:02,076] INFO [Controller id=0 epoch=17] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2022-08-14 08:34:02,076] INFO [Controller id=0 epoch=17] Sending UpdateMetadata request to brokers HashSet(0, 1) for 1 partitions (state.change.logger)
[2022-08-14 08:34:02,078] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 8 (state.change.logger)
[2022-08-14 08:34:02,494] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 0 (state.change.logger)
[2022-08-14 08:34:02,504] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 0 for 1 partitions (state.change.logger)
[2022-08-14 08:34:02,515] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 17 for partition ssl-topic-1 (last update controller epoch 17) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-14 08:34:02,519] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 17 with correlation id 1 for 0 partitions (state.change.logger)
[2022-08-14 08:34:02,525] INFO [Broker id=1] Finished LeaderAndIsr request in 22ms correlationId 1 from controller 0 for 1 partitions (state.change.logger)
[2022-08-14 08:34:02,531] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 2 (state.change.logger)
[2022-08-14 08:34:02,534] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 0 for 1 partitions (state.change.logger)
[2022-08-14 08:34:02,536] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 17 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-08-14 08:34:02,540] INFO [Broker id=1] Leader ssl-topic-1 starts at leader epoch 2 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-14 08:34:02,545] INFO [Broker id=1] Finished LeaderAndIsr request in 11ms correlationId 3 from controller 0 for 1 partitions (state.change.logger)
[2022-08-14 08:34:02,548] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 4 (state.change.logger)
[2022-08-14 08:34:05,577] INFO [Controller id=0 epoch=17] Sending UpdateMetadata request to brokers HashSet(0, 1) for 0 partitions (state.change.logger)
[2022-08-14 08:34:05,578] INFO [Controller id=0 epoch=17] Sending UpdateMetadata request to brokers HashSet(2) for 3 partitions (state.change.logger)
[2022-08-14 08:34:05,578] INFO [Controller id=0 epoch=17] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2022-08-14 08:34:05,579] INFO [Controller id=0 epoch=17] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2022-08-14 08:34:05,581] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 10 (state.change.logger)
[2022-08-14 08:34:05,582] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 6 (state.change.logger)
[2022-08-14 08:34:05,586] INFO [Controller id=0 epoch=17] Changed partition ssl-topic-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2022-08-14 08:34:05,586] INFO [Controller id=0 epoch=17] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2022-08-14 08:34:05,586] INFO [Controller id=0 epoch=17] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2022-08-14 08:34:05,587] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 11 (state.change.logger)
[2022-08-14 08:34:05,588] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 7 (state.change.logger)
[2022-08-14 08:34:05,992] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 0 (state.change.logger)
[2022-08-14 08:34:06,001] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 0 for 1 partitions (state.change.logger)
[2022-08-14 08:34:06,013] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 17 for partition ssl-topic-0 (last update controller epoch 17) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-14 08:34:06,016] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 0 epoch 17 with correlation id 1 for 0 partitions (state.change.logger)
[2022-08-14 08:34:06,022] INFO [Broker id=2] Finished LeaderAndIsr request in 22ms correlationId 1 from controller 0 for 1 partitions (state.change.logger)
[2022-08-14 08:34:06,027] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 2 (state.change.logger)
[2022-08-14 08:34:06,028] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 0 for 1 partitions (state.change.logger)
[2022-08-14 08:34:06,031] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 17 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-08-14 08:34:06,035] INFO [Broker id=2] Leader ssl-topic-0 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-14 08:34:06,040] INFO [Broker id=2] Finished LeaderAndIsr request in 12ms correlationId 3 from controller 0 for 1 partitions (state.change.logger)
[2022-08-14 08:34:06,042] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 4 (state.change.logger)
[2022-08-14 08:34:36,567] INFO [Controller id=0 epoch=17] Changed partition my-topic-0 state from NonExistentPartition to NewPartition with assigned replicas 0,2,1 (state.change.logger)
[2022-08-14 08:34:36,567] INFO [Controller id=0 epoch=17] Changed partition my-topic-1 state from NonExistentPartition to NewPartition with assigned replicas 2,1,0 (state.change.logger)
[2022-08-14 08:34:36,567] INFO [Controller id=0 epoch=17] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-14 08:34:36,568] INFO [Controller id=0 epoch=17] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-14 08:34:36,578] INFO [Controller id=0 epoch=17] Changed partition my-topic-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0, 2, 1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2022-08-14 08:34:36,578] INFO [Controller id=0 epoch=17] Changed partition my-topic-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2, 1, 0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2022-08-14 08:34:36,579] INFO [Controller id=0 epoch=17] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 1 become-follower partitions (state.change.logger)
[2022-08-14 08:34:36,579] INFO [Controller id=0 epoch=17] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2022-08-14 08:34:36,579] INFO [Controller id=0 epoch=17] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 1 become-follower partitions (state.change.logger)
[2022-08-14 08:34:36,579] INFO [Controller id=0 epoch=17] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 2 partitions (state.change.logger)
[2022-08-14 08:34:36,580] INFO [Controller id=0 epoch=17] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-14 08:34:36,580] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 12 from controller 0 for 2 partitions (state.change.logger)
[2022-08-14 08:34:36,580] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 5 from controller 0 for 2 partitions (state.change.logger)
[2022-08-14 08:34:36,580] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 8 from controller 0 for 2 partitions (state.change.logger)
[2022-08-14 08:34:36,582] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 12 from controller 0 epoch 17 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-08-14 08:34:36,582] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 0 epoch 17 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-08-14 08:34:36,592] INFO [Broker id=2] Leader my-topic-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2,1,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-14 08:34:36,593] INFO [Broker id=0] Leader my-topic-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0,2,1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-14 08:34:36,596] INFO [Broker id=1] Follower my-topic-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-08-14 08:34:36,601] INFO [Broker id=1] Follower my-topic-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-08-14 08:34:36,601] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 17 with correlation id 8 for 2 partitions (state.change.logger)
[2022-08-14 08:34:36,603] INFO [Broker id=2] Follower my-topic-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-08-14 08:34:36,603] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 0 epoch 17 with correlation id 5 for 1 partitions (state.change.logger)
[2022-08-14 08:34:36,606] INFO [Broker id=0] Follower my-topic-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2022-08-14 08:34:36,606] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 17 with correlation id 12 for 1 partitions (state.change.logger)
[2022-08-14 08:34:36,714] INFO [Broker id=2] Finished LeaderAndIsr request in 134ms correlationId 5 from controller 0 for 2 partitions (state.change.logger)
[2022-08-14 08:34:36,717] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 6 (state.change.logger)
[2022-08-14 08:34:36,723] INFO [Broker id=0] Finished LeaderAndIsr request in 143ms correlationId 12 from controller 0 for 2 partitions (state.change.logger)
[2022-08-14 08:34:36,726] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 13 (state.change.logger)
[2022-08-14 08:34:36,841] INFO [Broker id=1] Finished LeaderAndIsr request in 261ms correlationId 8 from controller 0 for 2 partitions (state.change.logger)
[2022-08-14 08:34:36,848] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 17 with correlation id 9 (state.change.logger)
