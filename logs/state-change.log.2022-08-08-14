[2022-08-08 22:28:18,515] INFO [Controller id=2 epoch=13] Sending UpdateMetadata request to brokers HashSet(1, 2) for 0 partitions (state.change.logger)
[2022-08-08 22:28:18,529] INFO [Controller id=2 epoch=13] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2022-08-08 22:28:18,531] INFO [Controller id=2 epoch=13] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2022-08-08 22:28:18,531] INFO [Controller id=2 epoch=13] Sending UpdateMetadata request to brokers HashSet(1, 2) for 2 partitions (state.change.logger)
[2022-08-08 22:28:18,539] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 2 for 1 partitions (state.change.logger)
[2022-08-08 22:28:18,540] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 13 for partition ssl-topic-0 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2022-08-08 22:28:18,540] INFO [Broker id=2] Finished LeaderAndIsr request in 1ms correlationId 1 from controller 2 for 1 partitions (state.change.logger)
[2022-08-08 22:28:18,543] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 2 (state.change.logger)
[2022-08-08 22:28:18,545] INFO [Controller id=2 epoch=13] Partition ssl-topic-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:13) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-08 22:28:18,546] INFO [Controller id=2 epoch=13] Sending UpdateMetadata request to brokers HashSet(1, 2) for 1 partitions (state.change.logger)
[2022-08-08 22:28:18,547] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 13 with correlation id 3 (state.change.logger)
[2022-08-08 22:28:18,561] ERROR [Controller id=2 epoch=13] Controller 2 epoch 13 failed to change state for partition ssl-topic-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition ssl-topic-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-08 22:28:18,563] INFO [Controller id=2 epoch=13] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-08 22:28:23,308] INFO [Controller id=2 epoch=13] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-08 22:28:23,310] INFO [Controller id=2 epoch=13] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
